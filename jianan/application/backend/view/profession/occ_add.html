{include file="public/header" /}<script src="__STATICBACKEND__/distpicker/js/distpicker.js"></script><!--<script src="__STATICBACKEND__/distpicker/js/main.js"></script>--><style type="text/css">  html{    background-color:#fff;  }  #province,#city,#area{    width:102px;    height:38px;    border: 1px solid #E6E6E6;  }</style><form class="layui-form"  style="margin-top:30px;width:90%;" id="addform" onkeydown="if(event.keyCode==13){return false;}">    <div class="layui-form-item">      <label class="layui-form-label">名称<span class="reqcolor">*</span></label>      <div class="layui-input-block">        <input type="text" name="name"  class="layui-input" lay-verify="required" value="{$data['ress']['name']|default=''}" >      </div>    </div>    <div class="layui-form-item">        <label class="layui-form-label">工种分类</label>        <div class="layui-input-block">            <select name="pid" id="pid" lay-filter="pid">                <option value="">请选择工种分类</option>                {foreach $cate_list as $k => $v}                <option value="{$v.id}" <?php if($data['ress']['pid'] == $v['id']) { ?> selected <?php }?>>{$v.name}</option>                {/foreach}            </select>        </div>    </div>    <div class="layui-form-item" style="text-align:center;">      <div class="layui-input-block">        <input  type="hidden" name='id' value="{$data['ress']['id']?$data['ress']['id']:''}" id='hidden-id'>        <button type="reset" class="layui-btn layui-btn-primary">重置</button>        <button class="layui-btn" lay-submit="" lay-filter="addaction">保 存</button>      </div>    </div></form><script>layui.config({    base: '__STATICBACKEND__/layuiadmin/' //静态资源所在路径  }).extend({    index: 'lib/index' //主入口模块  }).use(['index', 'form', 'laydate'], function(){    var $ = layui.$    ,form = layui.form;    form.on('select(cate_id)', function(data){        let v = data.value;        $.ajax({            type:"POST",            url:"{:url('Profession/selectData')}",            data: {cate_id : data.value},            dataType:"json",            success:function(res){                if (res.code == 1){                    let list = res.data;                    $("#pid").empty();                    var t;                    for (let i=0; i < list.length; i++){                        t += `<option value="`+list[i]['id']+`">`+list[i]['name']+`</option>`;                    }                    $("#pid").append(t);                    // 添加完记得render下  否则不会刷新到页面中                    form.render('select');                }else{                    $("#pid").empty();                }            },            error:function(res){                $("#pid").empty();                return false;            }        });    });    /* 监听提交 */    form.on('submit(addaction)', function(data){      var url = "{:url('customer/pro_add')}";      var data =$("#addform").serializeArray();      jqueryAjax('POST',url,data,successLayui);      return false;    });  });</script>