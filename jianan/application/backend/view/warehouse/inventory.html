{include file="public/header" /}<style type="text/css">  .layui-btn+.layui-btn {      margin-left: 0px;  }  .layui-card-header.layuiadmin-card-header-auto {      padding-top: 12px;      padding-bottom: 8px;  }  .layui-table-cell{      height:40px;      line-height: 40px;  }  .layui-tab{    margin: 10px 15px;  }</style><div class="layui-fluid">    <div class="layui-card">      <div class="layui-card-body ">          <div class="layui-form layui-card-header layuiadmin-card-header-auto" >              <div class="layui-form-item search" >                  <div class="layui-input-inline">                      <input type="text" name="name" placeholder="名称" autocomplete="off" class="layui-input">                  </div>                  <div class="layui-input-inline" style="width:100px;">                      <select name="type" lay-search="" id="type">                          <option value="">货物类型</option>                          <option value="1">固定资产</option>                          <option value="2">损耗品</option>                      </select>                  </div>                  <div class="layui-inline">                      <button class="layui-btn  layui-btn-normal " data-type="reload">                          <i class="layui-icon layui-icon-search layuiadmin-button-btn"></i>                      </button>                  </div>                  {if in_array('90',$rule_ids)}                  <button class="layui-btn" href="javascript:;" data-type="leading" style="background-color:#4cc149;"><i class="layui-icon">&#xe601;</i>导入</button>                  {/if}              </div>          </div>        <table id="layui-table" lay-filter="layui-table-tool"></table>        <script type="text/html" id="barTpl">            {if in_array('150',$rule_ids)}          <a class="layui-btn layui-btn-xs" lay-event="apply_remove">申请出库</a>          {/if}          {if in_array('151',$rule_ids)}          <a class="layui-btn layui-btn-xs" lay-event="remove">出库</a>          {/if}          {if in_array('152',$rule_ids)}          <a class="layui-btn layui-btn-xs" lay-event="scrap">报废</a>          {/if}          {if in_array('153',$rule_ids)}          <a class="layui-btn layui-btn-xs" lay-event="stockpile">增加库存</a>          {/if}          {if in_array('154',$rule_ids)}          <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="delete">删除</a>            {/if}        </script>          <script type="text/html" id="adminTpl">              {{ d.admin.real_name }}          </script>          <script type="text/html" id="numTpl">              {{ d.num }}{{ d.unit }}          </script>          <script type="text/html" id="priceTpl">              {{ d.price }}元/{{ d.unit }}          </script>          <script type="text/html" id="totalPriceTpl">              {{ d.price * d.num }}元          </script>      </div>    </div>  </div>  <script>    layui.use(['table','form','element'], function(){        var table = layui.table        , element = layui.element        , form = layui.form;        table.render({            elem: '#layui-table'            ,url: "{:Url('WarehouseGoods/getData')}" //数据接口            // ,width: 892            //,height: 500            ,height: 'full-180' //高度最大化减去差值            ,page: {                layout: ['limit', 'count', 'prev', 'page', 'next', 'skip'] //自定义分页布局                ,curr: 1 //设定初始在第 5 页                ,groups: 5 //只显示 1 个连续页码                ,first: false //不显示首页                ,last: false //不显示尾页            }            ,limit:15            ,where : {id:{$id}}            ,limits:[5,12,15,30,45,60,75,90]            ,cols: [[ //表头                // {type:'checkbox',fixed: 'left'},                {field: 'id', title: '编号',width:60}                ,{field: 'name', title: '名称',}                ,{title: '数量', templet: '#numTpl'}                ,{title: '价格', templet: '#priceTpl'}                ,{title: '总金额', templet: '#totalPriceTpl'}                ,{field: 'type_text', title: '货物类型'}                ,{field: 'create_time_text', title: '入库时间',width:180}                ,{title: '入库人', templet: '#adminTpl'}                ,{title: '操作', templet: '#barTpl',width:300}            ]]            ,id: 'tablereload'        });        var $ = layui.$, active = {          reload: function(){              //执行重载              table.reload('tablereload', {                  page: {                      curr: 1 //重新从第 1 页开始                  }                  ,where: {                      name: $('input[name="name"]').val(),                      type: $("#type option:selected").val(),                  }              });          },            leading:function(){                var url = "{:url('Warehouse/leading')}";                x_admin_show('导入仓库机器',url,400,300);            },        };        $('.search .layui-btn').on('click', function(){            var type = $(this).data('type');            active[type] ? active[type].call(this) : '';        });        //监听工具条        table.on('tool(layui-table-tool)', function(obj){            iss = $(this);            if(obj.event === 'apply_remove'){                var id = obj.data.id                var url = "{:Url('WarehouseGoods/apply_remove')}" + '?id=' + id;                x_admin_show('申请出库',url,600,600);            }else if(obj.event === 'remove'){                var id = obj.data.id                var url = "{:Url('WarehouseGoods/remove')}" + '?id=' + id;                x_admin_show('出库',url,600,600);            }else if(obj.event === 'scrap'){                var id = obj.data.id                var url = "{:Url('WarehouseGoods/scrap')}" + '?id=' + id;                x_admin_show('报废',url,1100,800);            }else if(obj.event === 'stockpile'){                var id = obj.data.id                var url = "{:Url('WarehouseGoods/stockpile')}" + '?id=' + id;                x_admin_show('增加库存',url,1100,800);            }else if(obj.event === 'delete'){                layer.confirm('确认要删除吗？删除就无法恢复了！',function(index){                    var data = {id: obj.data.id};                    var url = "{:Url('WarehouseGoods/delete')}";                    jqueryAjax('POST',url,data,successReload);                });            }        });    });  </script></body></html>