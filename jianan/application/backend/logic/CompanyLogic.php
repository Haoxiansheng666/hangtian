<?phpnamespace app\backend\logic;use app\backend\model\AdminUser;use app\backend\model\AuthGroup;class CompanyLogic{    /**     * 客户查询的逻辑     * @param $param     * @param $ausess     * @return array     * @throws \think\exception\DbException     */	static public  function selectParam($param,$ausess){        $where=[];        //客户名称        if(isset($param['name']) && !empty($param['name'])){            $where['c.company']=array('like',"%$param[name]%");        }        //手机号        if(isset($param['mobile']) && !empty($param['mobile'])){            $where['c.mobile']=array('like',"%$param[mobile]%");        }        //添加人        if(isset($param['auid']) && !empty($param['auid'])){            $where['c.auid']=$param['auid'];        }        if (!empty($param['status'])){            if (is_array($param['status'])){                $where['c.status'] = ['>',1];            }else{                $where['c.status'] = $param['status'];            }        }        if (empty($param['fa']) && empty($where['auid']) && !empty($ausess)){            // 权限设置            $group = AuthGroup::get($ausess['group_id']);            if ($group['pid'] == 0 && $group['department_id'] == 0){                $admin_ids = (new AdminUser())                    ->column('id');            }else if ($group['pid'] == 0 && $group['department_id'] == 7){                $admin_ids = (new AdminUser())                    ->where(['campus_id' => $ausess['campus_id']])                    ->column('id');            }else{                $top_group = AuthGroup::get($group['pid']);                if ($top_group['pid'] == 0){                    $admin_ids = (new AdminUser())                        ->where(['pid' => $ausess['auid'],'campus_id' => $ausess['campus_id']])                        ->column('id');                }else{                    $admin_ids = [];                }            }            $where['c.auid'] = ['in',array_merge([$ausess['auid']],$admin_ids)];        }        return $where;    }    /**     * 客户查询的逻辑     * @param $param     * @param $ausess     * @return array     * @throws \think\exception\DbException     */    static public  function select_Param($param,$ausess){        $where=[];        //客户名称        if(isset($param['name']) && !empty($param['name'])){            $where['company']=array('like',"%$param[name]%");        }        //手机号        if(isset($param['mobile']) && !empty($param['mobile'])){            $where['mobile']=array('like',"%$param[mobile]%");        }        //添加人        if(isset($param['auid']) && !empty($param['auid'])){            $where['auid']=$param['auid'];        }        if (!empty($param['status'])){            if (is_array($param['status'])){                $where['status'] = ['>',1];            }else{                $where['status'] = $param['status'];            }        }        if (empty($param['fa']) && empty($where['auid']) && !empty($ausess)){            // 权限设置            $group = AuthGroup::get($ausess['group_id']);            if ($group['pid'] == 0 && $group['department_id'] == 0){                $admin_ids = (new AdminUser())                    ->column('id');            }else if ($group['pid'] == 0 && $group['department_id'] == 7){                $admin_ids = (new AdminUser())                    ->where(['campus_id' => $ausess['campus_id']])                    ->column('id');            }else{                $top_group = AuthGroup::get($group['pid']);                if ($top_group['pid'] == 0){                    $admin_ids = (new AdminUser())                        ->where(['pid' => $ausess['auid'],'campus_id' => $ausess['campus_id']])                        ->column('id');                }else{                    $admin_ids = [];                }            }            $where['auid'] = ['in',array_merge([$ausess['auid']],$admin_ids)];        }        return $where;    }} 